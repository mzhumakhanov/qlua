Решение для отправки сообщений из терминала Квик в Телеграм (telegram bot api), отправка почты.

В решении используется библиотека Telegram.Bot https://github.com/TelegramBots/Telegram.Bot 

Консольная программа MessagesQServer.exe, выполняющая функцию Named Pipe Server и Telegram Bot, отправка почты.
Файл settings.ini должен быть расположен рядом с MessagesQServer.exe.
Библиотека luaPipe.dll - библиотека передачи данных (Named Pipe) в консольную программу (сервер).
Тестовый скрипт luaPipeTest.lua

В свои скрипты необходимо подключить библиотеку luaPipe.dll, обеспечить запуск MessagesQServer.exe.
Для запуска лучше использовать файл startTeleServer.bat. В нем происходит проверка, что сервер уже запущен.

Чтобы собрать MessagesQServer необходимо установить в проект пакет Telegram.Bot

В файле settings.ini необходимо заполнить токен, полученный при регистрации бота в телеграме.

ID Чата можно получить также через телеграм или можно отправить сообщение в созданном чате бота и сервер примет его и зарегестрируется на него.

Update.
Теперь проект (и собранная программа) называется MessagesQServer.
Помимо отправки сообщений в Телеграм добавлена возможность отправки почты.
Для этого необходимо включить отправку почты в настройках (значние ON), задать параметры smtp сервера.
Для отправки почты создается отдельный pipe канал (имя по умолчанию email_pipe).

Используя скрипт startTeleServer.bat при старте своего скрипта можно проверить, что сервер запущен, если нет, то запустить его.
Т.о. если он уже запущен не произойдет запуск дубля.

Ссылка на собранные библиотеки https://yadi.sk/d/QLT64ucTaLrjTQ

Небольшое видео работы
https://youtu.be/14c4nQiDdfU
